*****************************
* ERROR PROGRAM FOR SUITE 6 *
* COPYRIGHT UNDER SUITE 6   *
* AUTHOR: M.DEVRAJ          *
*****************************
PARAMETER ERR,MESS,PROG,LINE

IF ERR=1
 IF MODE="S"
  DO ERROR WITH "ONE OF THE DATABASES IS MISSING","CONSIDER REPAIRING OR RE-INSTALLING","FILE CHECK"
 ELSE
  DO ERROR WITH "YOU NETWORK SEEMS TO BE DOWN, CHECK YOUR NETWORK","SETTINGS OR DRIVE MAPPINGS","NETWORK ERROR"
 ENDIF
 STORE .T. TO _SOLVED
 RETURN .T.
ENDIF

IF ERR=1705
 STORE .T. TO _SOLVED
 DO ERROR WITH "A REQUESTED FILE COULD NOT BE LOCKED, IT SEEMS","TO BE IN NETWORK USE - ABORTING PROCESS","FILE ERROR"
 RETURN .T.
ENDIF

IF ERR=125 .OR. ERR=13
 STORE .T. TO _SOLVED
 DO ERROR WITH "YOUR PRINTER IS NOT RESPONDING","","PRINTER"
 if sys(13)="READY"
  set printer on
  set device to printer
  set console off
 endif
 RETURN .T.
ENDIF

IF ERR=15
 STORE .T. TO _SOLVED
 DO ERROR WITH "A DATABASE RELATED TO THE SUITE 6 SYSTEM","HAS BEEN DAMAGED","SYSTEM"
 RETURN .T.
ENDIF

CLOSE ALL DATABASES
DO ERROR WITH "AN UNEXPECTED ERROR OCCURED, SUITE 6 WILL NOW GENERATE","A LOG AND AUTOMATICALLY SHUTDOWN","SYSTEM HALTED"

STORE "NEW" TO _FLD
IF FILE('ERROR.LOG')
 STORE "OLD" TO _FLD
ENDIF
SET PRINTER TO ERROR.LOG ADDITIVE
SET PRINTER ON
SET CONSOLE OFF
SET DEVICE TO PRINTER
IF _FLD="NEW"
 ?"                                  ZOOM SUITE 6 ERROR LOG"
 ?"                                  ======================"
 ?" "
 ?"DATE        PROGRAM NAME   LNR  ERROR NO    COMPILER MESSAGE"
 ?"=========================================================================================="
ENDIF
?DTOC(ZOOM_DATE)+" "+PROG+"   "+STR(LINE,4)+" "+STR(ERR,6)+"  "+MESS
SET PRINTER TO LPT1
SET CONSOLE OFF
SET DEVICE TO SCREEN
CLOSE ALL
QUIT